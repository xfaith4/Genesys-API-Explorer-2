let _gknBrainTabOuterContainer;let _gknBrainTabToggleButton;let _gknBrainTabFrame;const availableProducts=["genesys-cloud-cx","genesys-engage-on-premises","genesys-multicloud-cx","pureconnect"];const availableThemes=["light","dark","navy"];braintab.init=(win,doc,attachId,id,_)=>{addDeveloperFunctions();listenForParentMessages(win,doc);_gknBrainTabOuterContainer=buildOuterContainer(doc,id);setBrainTabTheme(braintab.theme??"light");const e=doc.getElementById(attachId);if(e){e.appendChild(_gknBrainTabOuterContainer)}else{doc.documentElement.appendChild(_gknBrainTabOuterContainer)}if(firstTimeSeeingBrainTab()){const t=new Date;t.setDate(t.getDate()+25);window.onload=()=>{setTimeout(()=>{document.cookie="_gknBrainTabSeen=true;expires="+t.toString()+";path=/";_gknBrainTabToggleButton?.classList.add("braintabAnimation");setTimeout(()=>{_gknBrainTabToggleButton?.classList.remove("braintabAnimation")},3e3)},3e3)}}if(braintab.onInit){braintab.onInit(_gknBrainTabOuterContainer)}};const addDeveloperFunctions=()=>{braintab["setTheme"]=theme=>{setBrainTabTheme(theme);postMessageToParent("theme",theme)};braintab["setProduct"]=product=>{setProduct(product);postMessageToParent("product",product)};braintab["config"]=()=>{console.log(Object.keys(braintab).map(key=>`${key}: ${braintab[key]}\n`))};braintab["listThemes"]=()=>{console.log("- "+availableThemes.join("\n- "))};braintab["listProducts"]=()=>{console.log("- "+availableProducts.join("\n- "))};braintab["help"]=()=>{console.log("- "+["config(): show configuration and functions","theme: show the current theme","listThemes(): show available themes","setTheme(theme): set the active theme\n\tvalues\n\t- "+availableThemes.join("\n\t- "),"product: show the current product","listProducts(): show available products","setProduct(product): set the active product\n\tvalues\n\t- "+availableProducts.join("\n\t- ")].join("\n\n- "))}};const listenForParentMessages=(win,doc)=>{win.onmessage=e=>{if(typeof e.data==="string"||e.data instanceof String){if(e.data.startsWith("gcsdtbt-data")){const t=e.data.split("::");if(t.length>1){const a=t[1];const n=t[2];switch(a){case"login":onLogin(doc,n);postMessageToParent("theme",braintab.theme);break;case"logout":onLogout(doc);postMessageToParent("theme",braintab.theme);break;case"theme":setBrainTabTheme(n);break;case"product":setProduct(n);break;default:console.error(`Unhandled gcsdtbt data "${a}"`)}}}}}};const postMessageToParent=(key,data)=>{const e=["gcsdtbt-data",key];const t="::";if(data){e.push(data)}if(!!_gknBrainTabFrame?.contentWindow?.postMessage){_gknBrainTabFrame.contentWindow.postMessage(e.join(t),"*")}else{console.error('Brain tab embedded failed to post message to GKN iframe. "contentWindow.postMessage()" is undefined.')}};const setBrainTabTheme=theme=>{if(braintab.theme!=theme){braintab.theme=theme}switch(braintab.theme){case"dark":_gknBrainTabOuterContainer?.classList.add("theme-dark");_gknBrainTabOuterContainer?.classList.remove("theme-light");_gknBrainTabOuterContainer?.classList.remove("theme-navy");break;case"navy":_gknBrainTabOuterContainer?.classList.add("theme-navy");_gknBrainTabOuterContainer?.classList.remove("theme-light");_gknBrainTabOuterContainer?.classList.remove("theme-dark");break;case"light":default:_gknBrainTabOuterContainer?.classList.add("theme-light");_gknBrainTabOuterContainer?.classList.remove("theme-dark");_gknBrainTabOuterContainer?.classList.remove("theme-navy")}};const setProduct=product=>{if(braintab.product!=product){braintab.product=product}};const onLogin=(doc,data)=>{const e=JSON.parse(data);const t=e.initials;const a=e.numberOfCases;const n=doc.getElementById("gcsdtbt-toggle");const o=doc.createElement("div");const i=doc.createElement("div");i.className="ring";o.appendChild(i);const s=doc.createElement("div");s.className="profile";i.appendChild(s);const r=doc.createElement("span");r.innerText=t;r.translate="no";s.appendChild(r);const c=doc.createElement("div");c.innerText=a>99?"99+":a;c.className="notification-badge";if(a>0){o.appendChild(c)}n.innerHTML=o.innerHTML;if(braintab.onLogin){braintab.onLogin()}};const onLogout=doc=>{const e=doc.getElementById("gcsdtbt-toggle");e.innerHTML="";brainLogo=getBrainLogoEl(doc);e.appendChild(brainLogo)};const getBrainLogoEl=doc=>{const e=doc.createElement("img");e.className="gcsdtbt";e.src=`https://assets.genesyscsdt.com/assets/images/wave.svg`;e.alt="Orchestrators Tab Icon";return e};const buildOuterContainer=(doc,id)=>{const e=doc.createElement("div");e.id=id;e.classList.add("gcsdtbt");const t=buildInnerWrapper(e,doc);e.appendChild(t);return e};const buildInnerWrapper=(container,doc)=>{const e=doc.createElement("div");e.className="gcsdtbt-wrapper";_gknBrainTabToggleButton=doc.createElement("button");_gknBrainTabToggleButton.id="gcsdtbt-toggle";_gknBrainTabToggleButton.title="Toggle Button";_gknBrainTabToggleButton.ariaExpanded=false;_gknBrainTabToggleButton.ariaHasPopup=true;_gknBrainTabToggleButton.classList.add("gcsdtbt");const t="visible";const a="remove-right-border";_gknBrainTabToggleButton.onclick=()=>{if(container.classList.contains(t)){container.classList.remove(t);_gknBrainTabToggleButton.ariaExpanded=false;setTimeout(()=>_gknBrainTabToggleButton.classList.remove(a),700)}else{container.classList.add(t);_gknBrainTabToggleButton.ariaExpanded=true;_gknBrainTabToggleButton.classList.add(a)}if(braintab.onToggle){braintab.onToggle()}};const n=getBrainLogoEl(doc);_gknBrainTabToggleButton.appendChild(n);e.appendChild(_gknBrainTabToggleButton);const o=new URL("https://braintab.genesys.com");o.searchParams.set("product",braintab.product);o.searchParams.set("theme",braintab.theme);_gknBrainTabFrame=doc.createElement("iframe");_gknBrainTabFrame.className="gcsdtbt";_gknBrainTabFrame.src=o.toString();_gknBrainTabFrame.title="Brain Tab";e.appendChild(_gknBrainTabFrame);return e};const firstTimeSeeingBrainTab=()=>{const e=document.cookie?.split(";").filter(cookie=>{return cookie.trim().startsWith("_gknBrainTabSeen=")})?.[0];const t=e?.split("=")[1]??"false";return t!="true"};